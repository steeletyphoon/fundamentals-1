#!/usr/bin/env python3

import skilstak.colors as c
import random
import os 
import json

welcome_message = '''
Welcome to the magic eight ball!
Enter your question below.
'''

answers = []

def load_answers():
    with open(os.environ["FUNDATA"] + "/eightball.json") as f:
        answers = json.load(f);

def welcome():
    print(c.clear + c.rc() + welcome_message + c.reset)

def ask(prompt):
    answer = input(prompt).strip().lower()
    return answer

def bye():
    print("Goodbye. Come back soon!")
    exit()

def handle_question():
    question = ask("--> " + c.b3)
    print(c.reset, end='')
    if question == 'bye' or question == 'goodbye':
        bye()
    elif 'love' in question:
        print(c.red + 'Do I look like Cupid to you?' + c.x)
    elif 'die' in question or 'death' in question or 'dead' in question:
        print(c.red + "Such grim questions don't deserve an answer, yet." + c.x)
    else:
        answer = random.choice(answers)
        print(c.random_color() + answer + c.x)

if __name__ == '__main__':
    try: 
        welcome()
        load_answers()
        while True:
            handle_question()
    except KeyboardInterrupt:
        print()
        bye()
